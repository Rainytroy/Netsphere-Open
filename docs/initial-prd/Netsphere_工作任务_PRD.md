工作任务模块分为创建工作任务和工作任务列表两部分



# 创作工作任务

在这个页面中，除导航之外，功能被分为两部分，左侧的工作任务创建区，和右侧的全局变量列表区。



## 任务创建区

### 名称

名称是这个工作任务由用户定义的名称，即全局变量的来源名称，文本字段

注意，工作任务的名称并不是prompt的一部分



### 输入/INPUT

这里是一个文本输入框，我们可以成为INPUT输入框。这个文本框由用户编写输入内容，这将成为最终提交给AI服务的prompt的一部分。

左侧全局变量列表中的变量可以被插入到输入框中，它是一个标准组件，可以以一个标签块的形式插入到输入框中，样式是像一个tag标签样式一样作为一个整体。

#### 插入方式

1. 用户输入@后自行输入文本，如果输入了正确的全局变量名称，则将整段标识符转为一个tag样式

2. 用户在文本编辑光标区域，在右侧可用变量列表中，点击即可插入一个全局变量。



用户可以像操作文本一样，复制，粘贴和删除这个标签块。这是一个重要设计。



输入的这段文本，在工作任务被保存的时候，也会产生一个全局变量。

变量规则已经在全局变量模块约定过了



### 规则/Process

这里会给用户提供两个选项，一个是选择使用哪个NPC，一个是选择使用哪个AI服务。



### 输出/Output

当用户点击输出测试的按钮，一个通过prompt组合规则组合完毕的prompt，将传递给提供服务的AI，获得输出反馈。



输出的文本信息，在工作任务被保存的时候，也会产生一个全局变量。

变量规则已经在全局变量模块约定过了



#### 在编辑已创建的工作任务时，不可插入该工作任务的全局变量标识符

需要注意的一点是，本工作任务不可插入自己产生的输入和输出这两个全局变量，要提示用户该全局变量不可插入，否则会出现死循环。



# Prompt的组合规则

我们详细的介绍一下这个组合规则，最终我们提交给AI处理的prompt是一条文本，但是这条文本是在我们Netsphere中组装出来的。



## 组装规则是

### 1、INPUT 

文本内容

这里主要是由用户在输入框内输入文本，在输入文本时可以插入全局变量，可以插入任何一种当前系统中存在的全集变量



### 2、调用NPC

调用指定NPC会形成以下的固定文本内容（这个固定文本是预设的，但是也可以修改）

修改方式是在NPC选择模块后，有一个设置按钮，点击后以弹窗形式显示以下文本。这个文本框和INPUT的文本框一样，可以插入变量。

> 现在你具备的知识背景是：@NPC名称.知识背景，根据你的行动原则：@NPC名称.行动原则，请你给出以上输入的反馈。

用户可以编辑这段文本，调整最后拼装成prompt的内容。

弹窗可以保存，关闭，并提供一个重置按钮，把文本重置为以上内容。



最终提交给AI的Prompt，是由**INPUT的文本 + 调用NPC的文本**拼装成的









