全局变量是Netsphere的一个非常重要的功能模块,它可以承载信息在不同工作任务之间流转,让工作任务的prompt可以构建的详细充分。所以这两个需求会放在一起集中说明



# 全局变量

全局变量的主要结构，包括几个组成部分

## 类型

全局变量会来自不同的来源，目前包括

1. NPC

2. 工作任务

3. 自定义

4. 文件（这类变量包括文档、图片、视频等）

在之后的迭代中还会扩展和增加



### NPC

NPC的属性会被存储为变量，并且在NPC数据更新时更新

包括

1. 知识背景

2. 行动原则

3. 积极性参数的参数值

4. 积极性参数的描述

5. 描述

NPC的变量会在之后的功能迭代中扩展和增加

这一类变量随着NPC的创建而创建，随着NPC的删除而删除，随着对NPC字段的更新而更新



### 工作任务

在工作任务中，用户输入的prompt和最终由AI输出的结果都会被存储为全局变量

1. 输入：设计者输入的prompt

2. 输出：AI输出的内容

这一类变量随着工作任务的创建而创建，随着工作任务的删除而删除，随着对工作任务的更新而更新



### 自定义

完全由用户创建和自定义的全局变量

这一类变量由用户自主的进行增加、删除和修改



## 文件

在之后的迭代中，变量可以是一个文件，可以在AI处理中作为附件引用



## 全局变量的字段构成

- 每一个全局变量都有一个唯一的ID

- 全局变量根据创建方式分类

- 记录归属来源

- 按下表格式规则生成一个标识符，每一个全局变量的标识符是唯一的，标识符用来替代变量，当标识符被插入到文本框中，则等价于插入了变量文本到文本框中。

|类型|来源|标识符|
|-|-|-|
|NPC|NPC名称，例如：云透|@云透.知识背景|
|NPC|云透|@云透.行动原则|
|NPC|云透|@云透.积极性参数值|
|NPC|云透|@云透.积极性原则|
|NPC|云透|@云透.描述|
|工作任务|工作任务名称，例如：对需求结构化|@对需求结构化.input|
|工作任务|对需求结构化|@对需求结构化.output|
|自定义|自定义全局变量的名称|@自定义全局变量的名称|
|文件|文件名|@文档文件名|

标识符会因为来源名称的修改而更新，例如，当NPC 云透 改名为 茶叶蛋 之后，@云透.知识背景 这个标识符会更新为 @茶叶蛋.知识背景。

标识符需要被设计成一个组件，它可以以一个标签块的形式插入到输入框中，样式是像一个tag标签样式一样作为一个整体，用户可以像操作文本一样，复制，粘贴和删除这个标签块。



# Prompt的组合规则

最终我们提交给AI处理的prompt是一条文本，但是这条文本是在我们Netsphere中组装出来的。



组装规则是

1、INPUT 输入

文本内容

这里主要是由用户在输入框内输入文本，在输入文本时可以插入全局变量，可以插入任何一种当前系统中存在的全集变量



2、调用NPC

调用指定NPC会形成以下的固定文本内容（这个固定文本是预设的，但是也可以修改）

> 现在你具备的知识背景是：@NPC名称.知识背景

> 基于你的知识背景，根据你的行动原则：@云透.行动原则

> 请你给出以上输入的反馈



最终提交给AI的Prompt，是由INPUT的文本 + 调用NPC的文本拼装成的

注意，工作任务的名称并不是prompt的一部分

