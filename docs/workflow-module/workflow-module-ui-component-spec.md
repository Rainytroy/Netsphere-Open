# 工作流模块UI组件规范

**版本号**: v1.0.0  
**创建时间**: 2025年3月13日  
**文档状态**: 初稿  

> 本文档是Netsphere工作流模块的UI组件规范，详细描述各类组件的设计、样式和交互行为。
> 概念设计请参见：[工作流模块概念设计](workflow-module-concept-design.md)
> 技术实现细节请参见：[工作流模块技术规范](workflow-module-technical-spec.md)
> API接口详情请参见：[工作流模块API接口规范](workflow-module-api-spec.md)

## 目录
1. [设计语言和风格](#1-设计语言和风格)
2. [工作流列表页面组件](#2-工作流列表页面组件)
3. [工作流编辑器组件](#3-工作流编辑器组件)
4. [工作流使用界面组件](#4-工作流使用界面组件)
5. [卡片组件详细设计](#5-卡片组件详细设计)
6. [交互组件](#6-交互组件)
7. [响应式设计](#7-响应式设计)

## 1. 设计语言和风格

工作流模块UI设计遵循Netsphere系统的整体设计语言，保持风格一致性。

### 1.1 色彩规范

- **主题色**：深蓝色 (#1A1F2C)，用于导航背景和强调
- **辅助色**：
  - 浅灰色 (#F5F5F5)，用于背景和卡片
  - 蓝色 (#1890FF)，用于按钮、链接和交互元素
  - 绿色 (#52C41A)，用于成功状态和Yes连接
  - 红色 (#FF4D4F)，用于错误状态和No连接
  - 黄色 (#FAAD14)，用于警告和等待状态

### 1.2 字体规范

- **主要字体**：系统默认字体栈
  ```css
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif;
  ```
- **代码字体**：等宽字体，用于变量标识符
  ```css
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
  ```

### 1.3 字号规范

- **页面标题**：18px，粗体
- **卡片标题**：16px，粗体
- **正文**：14px，常规
- **小文本**：12px，常规
- **变量标识符**：13px，等宽字体

### 1.4 间距规范

- **页面内边距**：24px
- **卡片内边距**：16px
- **组件间距**：16px
- **表单项间距**：16px
- **段落间距**：12px

### 1.5 阴影和圆角

- **卡片阴影**：
  ```css
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  ```
- **卡片圆角**：8px
- **按钮圆角**：4px
- **输入框圆角**：4px

## 2. 工作流列表页面组件

### 2.1 工作流卡片

工作流卡片用于在列表页面展示工作流信息。

![工作流卡片示意图]()

**规格**：
- **宽度**：280px
- **高度**：自适应，最小高度160px
- **背景色**：白色
- **边框**：1px solid #e8e8e8
- **圆角**：8px
- **阴影**：标准卡片阴影

**内容结构**：
1. **卡片头部**：
   - 工作流名称（粗体，16px）
   - 状态指示点（右上角，8px直径圆点）
     - 草稿：灰色 (#D9D9D9)
     - 激活：绿色 (#52C41A)
     - 归档：深灰色 (#8C8C8C)
   
2. **卡片内容**：
   - 工作流描述（14px，最多3行，超出显示省略号）
   - 最后执行时间（12px，灰色文本）
   
3. **卡片底部**：
   - 操作按钮组（右对齐）：
     - 运行按钮
     - 编辑按钮
     - 更多操作下拉菜单（包含复制、删除等）

**交互行为**：
- 鼠标悬停时轻微上浮效果
- 点击卡片空白区域进入编辑页面
- 点击操作按钮执行对应操作

### 2.2 工作流列表筛选栏

位于工作流列表页面顶部，用于筛选和搜索工作流。

**规格**：
- **高度**：64px
- **背景色**：白色
- **边框底**：1px solid #e8e8e8

**组件结构**：
1. **左侧**：
   - 页面标题："工作流"（18px，粗体）
   
2. **中间**：
   - 搜索框（宽度240px）
   - 状态筛选下拉菜单（宽度120px）
   
3. **右侧**：
   - 创建工作流按钮（蓝色主色调按钮，#1890FF）

## 3. 工作流编辑器组件

### 3.1 顶部导航栏

位于工作流编辑器顶部，提供标题显示和操作按钮。

**规格**：
- **高度**：64px
- **背景色**：白色
- **边框底**：1px solid #e8e8e8
- **内边距**：左右24px

**组件结构**：
1. **左侧**：
   - 返回箭头图标
   - 页面标题："创建工作流"或"编辑工作流"
   - 工作流名称输入框（可编辑）
   - 编辑名称按钮（铅笔图标）
   
2. **右侧**：
   - 使用按钮（边框按钮，文本："使用"）
   - 保存按钮（主色调按钮，文本："保存"）
   - 退出按钮（灰色按钮，文本："退出"）

### 3.2 左侧卡片选择区

位于工作流编辑器左侧，提供可用卡片列表。

**规格**：
- **宽度**：400px
- **背景色**：#F5F5F5
- **内边距**：16px

**组件结构**：
1. **标签页**：
   - 流程卡标签
   - 工作任务卡标签
   
2. **卡片列表**：
   - 每个卡片项目高度：72px
   - 卡片图标（左）
   - 卡片名称和描述（中）
   - 已使用数量（右）

**交互行为**：
- 点击标签页切换显示内容
- 卡片项支持拖拽到画布
- 鼠标悬停时显示提示信息

### 3.3 画布区

工作流编辑器的主要区域，用于拖放和连接卡片。

**规格**：
- **宽度**：剩余空间
- **背景色**：白色，带有网格底纹
- **内边距**：0

**组件结构**：
1. **背景网格**：
   - 网格尺寸：20px × 20px
   - 网格线颜色：#F0F0F0
   
2. **卡片节点**：
   - 拖入画布的卡片实例
   - 根据卡片类型显示不同内容
   
3. **连接线**：
   - 默认连接线：#1890FF
   - Yes连接线：#52C41A
   - No连接线：#FF4D4F

**交互行为**：
- 支持拖入新卡片
- 支持移动已有卡片
- 支持选中卡片（显示四个连接点）
- 支持连接卡片（拖拽连接线）
- 支持删除卡片和连接线
- 支持画布平移

## 4. 工作流使用界面组件

### 4.1 用户输入区

位于工作流使用界面左侧，用于显示用户输入控件。

**规格**：
- **宽度**：600px
- **背景色**：白色
- **边框右**：1px solid #e8e8e8
- **内边距**：24px

**组件结构**：
1. **标题**：
   - "用户输入区"（16px，粗体）
   
2. **输入框**：
   - 提示文本（来自起点卡配置）
   - 多行文本输入框
   - 提交按钮
   
3. **运行状态**：
   - 加载指示器
   - 停止按钮
   - 运行状态文本

**交互行为**：
- 输入框支持多行文本输入
- 点击提交按钮后禁用，显示加载状态
- 显示停止按钮，可中断工作流执行

### 4.2 系统输出区

位于工作流使用界面右侧，用于显示工作流执行结果。

**规格**：
- **宽度**：剩余空间
- **背景色**：白色
- **内边距**：24px

**组件结构**：
1. **标题**：
   - "系统输出区"（16px，粗体）
   
2. **输出内容**：
   - Markdown渲染区域
   - 支持代码块、表格、列表等格式
   
3. **操作按钮**：
   - 导出MD按钮
   - 导出PDF按钮

**交互行为**：
- 支持文本内容逐字生成效果
- 自动滚动到最新内容
- 支持内容选择和复制
- 点击导出按钮下载对应格式的文件

## 5. 卡片组件详细设计

### 5.1 通用卡片组件

所有卡片类型共享的基础组件。

**规格**：
- **最小宽度**：180px
- **最小高度**：100px
- **背景色**：白色
- **边框**：1px solid #d9d9d9，选中时为2px solid #1890ff
- **圆角**：8px
- **内边距**：16px

**组件结构**：
1. **卡片头部**：
   - 卡片类型图标
   - 卡片名称
   - 删除按钮
   
2. **卡片内容**：
   - 根据卡片类型显示不同内容
   
3. **连接点**：
   - 顶部：输入连接点
   - 底部：输出连接点
   - 左侧和右侧：辅助连接点（仅在需要时显示）

**交互行为**：
- 选中时显示边框和连接点
- 支持拖动移动位置
- 双击打开编辑面板

### 5.2 起点卡

工作流的起点，接收用户输入。

**特有组件**：
1. **提示文本输入框**：
   - 多行文本输入框
   - 标签："提示文本"
   
2. **变量标识符显示**：
   - 显示格式：`@工作流名称.start`
   - 使用变量标识符样式

### 5.3 工作任务卡

执行已创建的工作任务。

**特有组件**：
1. **工作任务选择器**：
   - 下拉选择框
   - 显示所有可用工作任务
   
2. **信息显示区**：
   - 显示关联NPC和AI服务
   - 显示输入/输出变量标识符

### 5.4 赋值卡

在工作流执行过程中为变量赋值。

**特有组件**：
1. **赋值规则列表**：
   - 源变量选择器
   - 赋值箭头 (=)
   - 目标变量选择器
   - 删除按钮
   
2. **添加规则按钮**：
   - 位于赋值规则列表底部
   - 点击添加新行

### 5.5 循环卡

根据条件判断流转方向。

**特有组件**：
1. **条件类型选择**：
   - 单选按钮组
   - 选项：运行次数 / 变量值
   
2. **条件配置**：
   - 运行次数：次数输入框
   - 变量值：变量选择器 + 值输入框
   
3. **分支标识**：
   - Yes连接点：绿色
   - No连接点：红色

### 5.6 展示卡

在系统输出区显示变量内容。

**特有组件**：
1. **变量选择器**：
   - 下拉选择框
   - 选择要显示的变量
   
2. **显示方式选择**：
   - 单选按钮组
   - 选项：直接显示 / 生成式显示

## 6. 交互组件

### 6.1 变量选择器

用于选择全局变量的组件。

**规格**：
- **高度**：32px
- **背景**：白色
- **边框**：1px solid #d9d9d9
- **圆角**：4px

**组件结构**：
1. **输入框**：
   - 支持输入@触发变量搜索
   - 支持展示选中的变量标签
   
2. **下拉菜单**：
   - 变量列表
   - 按变量来源分组
   - 显示变量名称和标识符

**交互行为**：
- 输入@字符触发下拉菜单
- 输入文本过滤变量列表
- 选中变量插入为变量标签

### 6.2 卡片属性面板

用于编辑卡片属性的浮动面板。

**规格**：
- **宽度**：320px
- **背景**：白色
- **阴影**：0 2px 8px rgba(0, 0, 0, 0.15)
- **圆角**：8px
- **内边距**：16px

**组件结构**：
1. **面板标题**：
   - 卡片类型图标
   - 卡片类型名称
   - 关闭按钮
   
2. **属性表单**：
   - 根据卡片类型显示不同表单项
   - 保存按钮

**交互行为**：
- 双击卡片或点击编辑按钮打开
- 点击外部区域关闭
- 保存后立即应用更改

### 6.3 连接线编辑器

用于编辑连接线属性的浮动工具栏。

**规格**：
- **高度**：32px
- **背景**：白色
- **阴影**：0 2px 8px rgba(0, 0, 0, 0.15)
- **圆角**：16px
- **内边距**：8px

**组件结构**：
1. **标签输入框**：
   - 输入连接线标签文本
   
2. **颜色选择器**：
   - 预设颜色选项
   
3. **删除按钮**：
   - 删除连接线

**交互行为**：
- 点击连接线显示工具栏
- 自动定位到连接线中点位置
- 修改后立即应用更改

## 7. 响应式设计

### 7.1 断点定义

- **大屏**：≥ 1200px
- **中屏**：≥ 992px 且 < 1200px
- **小屏**：≥ 768px 且 < 992px
- **超小屏**：< 768px

### 7.2 布局调整

**大中屏**：
- 左侧卡片选择区宽度：400px
- 用户输入区宽度：600px

**小屏**：
- 左侧卡片选择区宽度：320px
- 用户输入区宽度：500px

**超小屏**：
- 工作流编辑界面：
  - 左侧卡片选择区转为顶部选项卡
  - 画布区占满剩余空间
- 工作流使用界面：
  - 用户输入区和系统输出区上下排列
  - 各占50%高度

### 7.3 组件适应

- **工作流卡片**：
  - 大中屏：每行3-4张卡片
  - 小屏：每行2张卡片
  - 超小屏：每行1张卡片
  
- **卡片组件**：
  - 根据屏幕大小调整内部元素排列
  - 小屏幕下简化显示内容
